<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>歡迎光臨</title>
    <link rel="stylesheet" href="{{ url_for('static', path='style.css') }}">
    <script src="{{ url_for('static', path='main.js') }}" defer></script>
</head>
<body>
    <header class="hero">
        <div class="container">
            <h1 class ="hero_title">歡迎光臨，這是會員頁</h1>
        </div>
    </header>

    <main class="container">
        <div class="message">
            <p>{{ name }}，歡迎登入系統</p>
            <p><a href="/logout">登出系統</a></p>
        </div>
        
        <div class="divider"></div>

        <div class="message">
            <p><strong>快來留言吧</strong></p>
            <form id="message-form" action="/createMessage" method="post">
                <div class="form-row">
                    <label for="msg-content">內容</label>
                    <input type="text" id="msg-content" name="content">
                </div>
                <div class="form-actions">
                        <button type="submit" class="btn">送出</button>
                </div>
            </form>
        </div>

        <div class="divider"></div>

        <section class="card">
             {% for msg in messages or [] %} <!-- 確保 messages 是 None 或沒傳（undefined）時得到 []，for 迴圈預設不會跑 [] -->
                <div class="form-row">
                    <div>
                    <strong>{{ msg.name }}：</strong>{{ msg.content }}
                    </div>
                    {% if msg.member_id == id %}
                    <form class="delete-form" method="post" action="/deleteMessage">
                        <input type="hidden" name="message_id" value="{{ msg.message_id }}">  <!--hidden input 是一種「看不到但會跟著表單一起送出的資料欄位」，讓後端知道要刪的是哪則留言 -->
                        <button class="btn">✕</button>
                    </form>
                    {% endif %}
                </div>
            {% endfor %}
        </section>
        
    </main>

</body>
</html>